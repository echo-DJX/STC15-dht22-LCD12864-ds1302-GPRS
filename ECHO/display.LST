C51 COMPILER V9.02   DISPLAY                                                               09/27/2019 09:57:40 PAGE 1   


C51 COMPILER V9.02, COMPILATION OF MODULE DISPLAY
OBJECT MODULE PLACED IN display.OBJ
COMPILER INVOKED BY: F:\Keil\C51\BIN\C51.EXE display.c LARGE BROWSE DEBUG OBJECTEXTEND

line level    source

   1          //===============================头文件调用===========================//
   2          #include "bsp.h"
   3          
   4          char xdata lcdstr[32];
   5          
   6          //uint xdata hour,min,sec;
   7          //uint xdata year,month,day;
   8          
   9          //====================================================================//
  10          //      语法格式：      void Temperature_Display(uint temp_value)
  11          //      实现功能：      在LCD上显示“温度”
  12          //      参数：          uint temp_value
  13          //      返回值：        无
  14          //====================================================================//
  15          
  16          //====================================================================//
  17          //      语法格式：      void Data_Display(void) 
  18          //      实现功能：      在LCD上显示“日期”
  19          //      参数：          无
  20          //      返回值：        无
  21          //====================================================================//
  22          void Date_Display(unsigned char row,unsigned char col)                  
  23          {
  24   1              uchar tmp;
  25   1              uchar  high,low;
  26   1              uint year1,month1,day1;
  27   1      //      uchar str[]="DS16(10,100,'日期：2015-01-01',12);\r\n";
  28   1      
  29   1              tmp=timenow[6];                                 //取出年
  30   1      //      tmp=0x15;
  31   1              low=tmp&0x0f;                            
  32   1              high=(tmp&0xf0)>>4;
  33   1              year1=(uint)high*10+low;        
  34   1              if (year1<100)
  35   1                 {year=year1;
  36   2                 }            
  37   1      
  38   1              tmp=timenow[4];                                 //取出月
  39   1      //      tmp=0x02;
  40   1              low=tmp&0x0f;                           
  41   1              high=(tmp&0xf0)>>4;     
  42   1              month1=(uint)high*10+low;
  43   1              if (month1<13)
  44   1                 {month=month1;
  45   2                 }            
  46   1      
  47   1              tmp=timenow[3];                                 //取出日
  48   1      //      tmp=0x23;                                                               
  49   1              low=tmp&0x0f;                           
  50   1              high=(tmp&0xf0)>>4;             
  51   1          day1=(uint)high*10+low;
  52   1              if (day1<32)
  53   1                 {day=day1;
  54   2                 }    
  55   1              sprintf(lcdstr,"日期：20%02d-%02d-%02d",year,month,day); 
C51 COMPILER V9.02   DISPLAY                                                               09/27/2019 09:57:40 PAGE 2   

  56   1          PutStr(row,col,lcdstr);
  57   1          Delay1ms();
  58   1      }
  59          
  60          //====================================================================//
  61          //      语法格式：      void Time_Display(void) 
  62          //      实现功能：      在LCD上显示“时间”
  63          //      参数：          无
  64          //      返回值：        无
  65          //====================================================================//
  66          void Time_Display(unsigned char row,unsigned char col)                  
  67          {
  68   1              uchar tmp;
  69   1              uint  high,low;
  70   1              uint hour1,min1,sec1;
  71   1      
  72   1             tmp=timenow[2];                                  //取出时
  73   1                 low=tmp&0x0f;                                
  74   1                 high=(tmp&0xf0)>>4;                  
  75   1             hour1=high*10+low;
  76   1                 if (hour1<24)
  77   1                 {hour=hour1;
  78   2                 }
  79   1      
  80   1                 tmp=timenow[1];                                      //取出分                                                        
  81   1                 low=tmp&0x0f;                                
  82   1                 high=(tmp&0xf0)>>4;                  
  83   1                 min1=high*10+low;
  84   1                 if (min1<60)
  85   1                 {min=min1;
  86   2                 }
  87   1      
  88   1                 tmp=timenow[0];                                  //取出秒
  89   1      //         tmp=0x49;
  90   1                 low=tmp&0x0f;                                
  91   1                 high=(tmp&0xf0)>>4;          
  92   1                 sec1=high*10+low;
  93   1                 if (sec1<60)
  94   1                 {sec=sec1;
  95   2                 }
  96   1      
  97   1           sprintf(lcdstr,"时间：%02d:%02d:%02d",hour,min,sec);
  98   1               PutStr(row,col,lcdstr);
  99   1               Delay1ms();
 100   1                       
 101   1      }
 102          void wendu_Display(unsigned char row,unsigned char col)
 103          {  
 104   1           uint tmp,tmp1,tmp2;
 105   1               if(RH_DATA[2]<128)
 106   1               {
 107   2                 tmp=RH_DATA[2]*256+RH_DATA[3];
 108   2                 tmp1=tmp/10;
 109   2                 tmp2=tmp%10;
 110   2                 sprintf(lcdstr,"温度：%2d.%1dC",tmp1,tmp2);
 111   2                 PutStr(row,col,lcdstr);
 112   2               }
 113   1               else
 114   1               {
 115   2                 tmp=(RH_DATA[2]-128)*256+RH_DATA[3];
 116   2                 tmp1=tmp/10;
 117   2                 tmp2=tmp%10;
C51 COMPILER V9.02   DISPLAY                                                               09/27/2019 09:57:40 PAGE 3   

 118   2                 sprintf(lcdstr,"温度：-%2d.%1dC",tmp1,tmp2);
 119   2                 PutStr(row,col,lcdstr);
 120   2               }
 121   1               Delay1ms();
 122   1      }
 123          void shidu_Display(unsigned char row,unsigned char col)
 124          {        
 125   1           uint tmp,tmp1,tmp2;
 126   1               tmp=RH_DATA[0]*256+RH_DATA[1];
 127   1               tmp1=tmp/10;
 128   1               tmp2=tmp%10;
 129   1           sprintf(lcdstr,"湿度：%2d.%1d%%",tmp1,tmp2);
 130   1               PutStr(row,col,lcdstr);
 131   1               Delay1ms();
 132   1      }
 133          
 134          void RH_Display(unsigned char row,unsigned char col)
 135          {  
 136   1           uint  tmp,tmp1,tmp2,tmp3,tmp4;
 137   1               tmp=RH_DATA[0]*256+RH_DATA[1];
 138   1               tmp1=tmp/10;
 139   1               tmp2=tmp%10;
 140   1               if(RH_DATA[2]<128)
 141   1               {
 142   2                 tmp=RH_DATA[2]*256+RH_DATA[3];
 143   2                 tmp3=tmp/10;
 144   2                 tmp4=tmp%10;
 145   2                 sprintf(lcdstr,"H=%2d.%1d%% T=%2d.%1dC",tmp1,tmp2,tmp3,tmp4);
 146   2                 PutStr(row,col,lcdstr);
 147   2               }
 148   1               else
 149   1               {
 150   2                 tmp=(RH_DATA[2]-128)*256+RH_DATA[3];
 151   2                 tmp3=tmp/10;
 152   2                 tmp4=tmp%10;
 153   2                 sprintf(lcdstr,"H=%2d.%1d%% T=-%2d.%1dC",tmp1,tmp2,tmp3,tmp4);
 154   2                 PutStr(row,col,lcdstr);
 155   2               }
 156   1               Delay1ms();
 157   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1200    ----
   CONSTANT SIZE    =    138    ----
   XDATA SIZE       =     32      32
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
